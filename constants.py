UDP_MTU = 65535

# UDP channel

IPV4_LEN = 4
PORT_LEN = 2

MIN_PORT = 50000
MAX_PORT = 60000

CHAN_ID_SIZE = 2

MIN_CHAN_ID = 1
MAX_CHAN_ID = 2**(8*CHAN_ID_SIZE)-1

REPLAY_WINDOW_SIZE = 10

# sym encryption

SYM_KEY_LEN = 16

CTR_PREFIX_LEN = 8
CTR_START_LEN = 8
CTR_MODE_PADDING = CTR_PREFIX_LEN

# link encryption

LINK_CTR_START = 0

NONCE_LEN = 16

FLAG_LEN = 1
RESERVED_LEN = 5

DATA_MSG_FLAG = b"\x01"
CHAN_INIT_MSG_FLAG = b"\x02"
CHAN_CONFIRM_MSG_FLAG = b"\x03"

GCM_MAC_LEN = 16

LINK_HEADER_LEN = CHAN_ID_SIZE + CTR_PREFIX_LEN + FLAG_LEN + RESERVED_LEN

# mix messages

MIX_COUNT = 3

# data message

DATA_OVERHEAD = (MIX_COUNT-1) * CTR_PREFIX_LEN

# biggest UDP packet seen in the wild was 1360, which gets divided equally by 272

FRAG_PAYLOAD_SIZE = 272

# init message

GROUP_ELEMENT_LEN = 29

INIT_PAYLOAD_LEN = IPV4_LEN + PORT_LEN

INIT_OVERHEAD = GROUP_ELEMENT_LEN + MIX_COUNT * SYM_KEY_LEN + INIT_PAYLOAD_LEN

assert INIT_OVERHEAD >= DATA_OVERHEAD
